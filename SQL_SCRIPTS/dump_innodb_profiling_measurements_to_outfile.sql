/* ------------------------------------------------------------------------- */
-- Written by Kevin Martin.
/* ------------------------------------------------------------------------- */
-- This file sends the measurement table generated by the innodb_profiling
-- stored procedure to an output file. This will be a CSV with headers.
--
-- DEBUG NOTE: Outfile privelege may require root access.
/* ------------------------------------------------------------------------- */

USE innodb_profiling;

-- The first select statement adds each column header. The second component
-- of the statement selects all rows in the innodb_profiling.my_measurement_table.
-- This is all sent to an output file specified in the last clause of the query,
-- which will be formatted as a CSV, with comma-separated values.
SELECT 'real_size', 'default_sample_estimate', 'sample_10_pages_estimate',
    'sample_100_pages_estimate', 'sample_1000_pages_estimate'
UNION ALL
SELECT
    real_size,
    default_sample_estimate,
    sample_10_pages_estimate,
    sample_100_pages_estimate,
    sample_1000_pages_estimate
FROM my_measurement_table

-- NOTE: This can be used to only dumb a limited sample for testing
-- LIMIT 25 

INTO OUTFILE '~/profiling_innodb_statistics_table_size_estimation.txt'
FIELDS TERMINATED BY ',' ENCLOSED BY '"'
LINES TERMINATED BY '\n';

-- Notes on the my_measurement_data table: The columns in the data table are
-- of type INT(11), and *can* be NULL. Be sure to check whether these are
-- included in the data set!
